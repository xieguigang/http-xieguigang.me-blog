<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>LDheatmap - An R Function for Graphical Display of Pairwise Linkage Disequilibria between Single Nucleotide Polymorphisms | 拾荒者</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="AbstractWe describe the R function LDheatmap() which produces a graphical display, as a heat map, of pairwise linkage disequilibrium measurements between single nucleotide polymorphisms within a genom">
<meta property="og:type" content="article">
<meta property="og:title" content="LDheatmap - An R Function for Graphical Display of Pairwise Linkage Disequilibria between Single Nucleotide Polymorphisms">
<meta property="og:url" content="http://blog.xieguigang.me/2016/08/21/LDheatmap/index.html">
<meta property="og:site_name" content="拾荒者">
<meta property="og:description" content="AbstractWe describe the R function LDheatmap() which produces a graphical display, as a heat map, of pairwise linkage disequilibrium measurements between single nucleotide polymorphisms within a genom">
<meta property="og:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure5.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/qrcode/LDheatmap.png">
<meta property="og:updated_time" content="2016-08-21T17:12:55.617Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LDheatmap - An R Function for Graphical Display of Pairwise Linkage Disequilibria between Single Nucleotide Polymorphisms">
<meta name="twitter:description" content="AbstractWe describe the R function LDheatmap() which produces a graphical display, as a heat map, of pairwise linkage disequilibrium measurements between single nucleotide polymorphisms within a genom">
<meta name="twitter:image" content="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure1.png">
    

    
        <link rel="alternate" href="/" title="拾荒者" type="application/atom+xml" />
    

    
        <link rel="icon" href="http://xieguigang.me/favicon.ico" />
    

    <link rel="stylesheet" href="/vendor/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/vendor/open-sans/styles.css">
    <link rel="stylesheet" href="/vendor/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/vendor/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/vendor/fancybox/jquery.fancybox.css">
    
    
    
    

</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">拾荒者</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/.">Home</a>
                
                    <a class="main-nav-link" href="/archives">Archives</a>
                
                    <a class="main-nav-link" href="/nuget">nuget</a>
                
                    <a class="main-nav-link" href="/about">About</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/my/WeChatImage636059681622385094.jpg" />
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/.">Home</a></td>
                
                    <td><a class="main-nav-link" href="/archives">Archives</a></td>
                
                    <td><a class="main-nav-link" href="/nuget">nuget</a></td>
                
                    <td><a class="main-nav-link" href="/about">About</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/my/WeChatImage636059681622385094.jpg" />
            <h2 id="name">xieguigang</h2>
            <h3 id="title">GCModeller chief developer</h3>
            <span id="location"><i class="fa fa-map-marker"></i>GuiLin, China (中國 · 桂林)</span>
            <a id="follow" target="_blank" href="https://github.com/xieguigang">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                53
                <span>posts</span>
            </div>
            <div class="article-info-block">
                110
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="http://github.com/xieguigang" target="_blank" title="github" class=tooltip>
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="twitter" class=tooltip>
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/" target="_blank" title="rss" class=tooltip>
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main"><article id="post-LDheatmap" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
            LDheatmap - An R Function for Graphical Display of Pairwise Linkage Disequilibria between Single Nucleotide Polymorphisms
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2016/08/21/LDheatmap/">
            <time datetime="2016-08-20T16:00:00.000Z" itemprop="datePublished">2016-08-21</time>
        </a>
    </div>


                        
                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/R/">R</a>, <a class="tag-link" href="/tags/R-squared/">R-squared</a>, <a class="tag-link" href="/tags/SNP/">SNP</a>, <a class="tag-link" href="/tags/genetics/">genetics</a>, <a class="tag-link" href="/tags/heatmap/">heatmap</a>
    </div>

                    </div>
                
            </header>
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>We describe the R function <code>LDheatmap()</code> which produces a graphical display, as a heat map, of pairwise linkage disequilibrium measurements between single nucleotide polymorphisms within a genomic region. <code>LDheatmap()</code> uses the grid graphics system, an alternative to the traditional R graphics system. The features of the <code>LDheatmap()</code> function and the use of tools from the grid package to modify heat maps are illustrated by examples.</p>
<p><strong>Keywords:</strong> single nucleotide polymorphisms, linkage disequilibrium, grid graphics.</p>
<a id="more"></a>
<h2 id="1-Introduction"><a href="#1-Introduction" class="headerlink" title="1. Introduction"></a>1. Introduction</h2><p>Single nucleotide polymorphisms (SNPs) are the most common form of genetic variation in the human genome. Due to their abundance and ease of genotyping, SNPs have become popular markers for genetic association studies. Although identifying as many SNPs as possible within a candidate gene is important in finding disease susceptibility alleles, typing them all can be expensive, and testing them for association with traits can lead to multiple-comparison issues. Moreover, due to genetic linkage, nearby SNPs within candidate genes are often highly correlated. Hence, it has become common practice to instead genotype only a subset of SNPs within a candidate gene.<br>Understanding the patterns of association or linkage disequilibrium (LD) between SNPs can aid in selecting SNP subsets. However, for a dense map of SNPs, it can be difficult to interpret results from tabular summaries of pairwise LD measurements since the number of measurements increases rapidly with the number of SNPs within a genomic region. As a tool for interpretation of LD patterns, we developed an R (R Development Core Team 2006) function <code>LDheatmap()</code> which provides a graphical summary of pairwise LD measurements as a heat map.</p>
<h2 id="2-LDheatmap-Overview"><a href="#2-LDheatmap-Overview" class="headerlink" title="2. LDheatmap(): Overview"></a>2. LDheatmap(): Overview</h2><p>The function <code>LDheatmap()</code> takes an input data set that provides information on pairwise LD between SNPs in a genomic region, plots color-coded values of the pairwise LD measurements, and returns an object of class “LDheatmap” containing a number of components.<br>The input data set can be a data frame containing SNP genotypes, a matrix of pairwise LD measurements, or an LDheatmap object returned by the function <code>LDheatmap()</code>. <strong>SNP genotypes must be genotype objects created by the <code>genotype()</code> function from the genetics package (Warnes and Leisch 2005)</strong>. When genotypes are provided, LD measurements are computed using the function LD() from the genetics package. The user can specify either the squared allelic correlation r2 (Pritchard and Przeworski 2001) or Lewontin’s |D0| (Lewontin 1964) as the measure of LD to be plotted. Users who have pre-computed pairwise r2 or |D0| measures, or who wish to plot some other measure of pairwise LD can provide a matrix of LD measurements instead of genotypes. In fact, any square matrix with values between 0 and 1 inclusive above the diagonal can be displayed by <code>LDheatmap()</code>. When <code>LDheatmap()</code> is passed an object of class “LDheatmap”, the function uses the object’s LDmatrix component. LDmatrix is the matrix of LD measurements produced by or passed to the previous function call used to create the LDheatmap object. An optional diagonal line, drawn from the bottom left to the top right of the display, can be added to indicate physical or genetic map positions of the SNPs, along with text reporting the total length of the genetic region in either kilobases (kb; for physical distance) or centi-Morgans (cM; for genetic distance). In the display of LD, SNPs appear along this diagonal line in the order specified by the user, as the horizontal and vertical coordinates increase. The ordering is achieved by adopting the conventions of the <code>image()</code> function, in which horizontal coordinates of the display correspond to rows of the matrix and vertical coordinates correspond to columns, and vertical coordinates are indexed in increasing order from bottom to top (rather than top to bottom as in a matrix).<br>LDheatmap() depends on the grid package; the graphics functions of <code>LDheatmap()</code> are written in the grid graphics system (Murrell 2005) which provides more flexibility when manipulating a plot than the traditional graphics system. Consequently, traditional graphics functions such as par() do not have any effect on <code>LDheatmap()</code>. The next section provides examples of the use of <code>LDheatmap()</code> and shows how heat maps can be modified using functions from the grid package.</p>
<h2 id="3-Illustration"><a href="#3-Illustration" class="headerlink" title="3. Illustration"></a>3. Illustration</h2><p>The hapmapCEU data set from the LDheatmap package will be used in the next examples.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(LDheatmap)</span><br><span class="line">data(<span class="string">"CEUData"</span>)</span><br></pre></td></tr></table></figure>
<p>This will load the genetic data CEUSNP and associated distance vector CEUDist included in the package. The CEUSNP data-set is a data frame of genotypes for 15 SNPs on chromosome 7, obtained from 60 Utah residents with northern and western European ancestry. These data are from release 7 of the International HapMap project (The International HapMap Consortium 2005); see the <code>hapmapCEU</code> help file for a more complete description. The CEUDist vector contains the physical map locations (base-pair positions) of the 15 SNPs.<br>The following example shows a typical call to the LDheatmap() function. The heat map generated by this call is shown in Figure 1.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MyHeatmap &lt;- LDheatmap(CEUSNP, CEUDist, LDmeasure = <span class="string">"r"</span>,</span><br><span class="line">    title = <span class="string">"Pairwise LD in r^2"</span>, add.map = <span class="literal">TRUE</span>,</span><br><span class="line">    SNP.name = c(<span class="string">"rs2283092"</span>, <span class="string">"rs6979287"</span>), color = grey.colors(<span class="number">20</span>),</span><br><span class="line">    name = <span class="string">"myLDgrob"</span>, add.key = <span class="literal">TRUE</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure1.png" alt="Figure 1: Heat map of pairwise LD measurements for the 15 SNPs in CEUSNP produced by LDheatmap()."></p>
<p>Each colored rectangle represents the squared correlation r2 between a pair of SNPs (specified by <code>LD.measure=&quot;r&quot;</code>). The vector CEUDist of physical map locations of the 15 SNPs provides the information on their relative positions, which are indicated on the diagonal line by line segments, and the total length of the genetic region indicated by the text “Physical Length:8.9kb” (all added by <code>add.map=TRUE</code>). Two of the SNPs are labeled by <code>SNP.name = c(&quot;rs2283092&quot;, &quot;rs6979287&quot;)</code>. It is also possible to label selected SNPs without showing the other genetic information by specifying add.map=FALSE. The default grey-scale colorscheme is specified by color=grey.colors(20) and is indicated by the ‘Color Key’ on the bottom right corner of the plot (<code>add.key=TRUE</code>).<br>When the function is called, a grid graphical object (grob) named LDheatmapGrob, representing the heat map, is created and the graphical output is produced from this grob. The grob is also one of the components of the LDheatmap object returned by the <code>LDheatmap()</code> function. In this example, the returned LDheatmap object is stored as MyHeatmap, and its LDheatmapGrob component has name “myLDgrob”.<br>LDheatmapGrob is a gTree object (Murrell 2006a) and has a hierarchical structure as shown in Figure 2. The children of LDheatmapGrob represent the heat map (“heatMap”), optional line parallel to the diagonal of the image indicating the physical or genetic map positions of the SNPs (“geneMap”), and color-scale (“Key”).<br>The children of “heatMap” represent the region of colored rectangles (“heatmap”) and main title (“title”) of the heat map. When add.map=TRUE, “geneMap” is created with children representing the diagonal line (“diagonal”), line segments (“segments”) and text reporting the total length of the candidate region (“title”). When the parameter SNP.name is specified to label one or more SNPs, as in our example, two additional children are created, representing the labels (“SNPnames”) and the symbols plotted at the tips of the corresponding line segments<br>(“symbols”). When add.map=FALSE and SNP.name is specified, only “SNPnames” is created. When add.key=TRUE, “Key” is created with children which represent the colored rectangles (“colorKey”), title (“title”), numeric labels (“labels”), ticks (“ticks”) and box frame<br>(“box”) of the color legend. These grobs can be used to modify a heat map produced by the <code>LDheatmap()</code>. In the next section, we will show how to do this by examples.</p>
<p><img src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure2.png" alt="Figure 2: Hierarchical structure of LDheatmapGrob, the grob created by LDheatmap() to produce an LD heat map."></p>
<h2 id="4-Modifying-a-heat-map"><a href="#4-Modifying-a-heat-map" class="headerlink" title="4. Modifying a heat map"></a>4. Modifying a heat map</h2><p>Modifying an LD heat map produced by <code>LDheatmap()</code> can be done interactively or statically using the functions <code>grid.edit()</code> or <code>editGrob()</code>, respectively (Murrell 2006a). Interactive editing requires that a grob be drawn on the current device, such as the grob named “myLDgrob” on the current display in our example. Static editing requires that a grob be saved in the user’s workspace, such as the LDheatmapGrob component of the MyHeatmap object saved in our example. Suppose we wish to modify the font sizes and colors of the main title, text indicating the genetic region length and title of the color key. We can do so interactively with</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grid.edit(gPath(<span class="string">"myLDgrob"</span>, <span class="string">"heatMap"</span>, <span class="string">"title"</span>),</span><br><span class="line">    gp = gpar(cex = <span class="number">1.25</span>, col = <span class="string">"blue"</span>))</span><br><span class="line">grid.edit(gPath(<span class="string">"myLDgrob"</span>, <span class="string">"geneMap"</span>, <span class="string">"title"</span>),</span><br><span class="line">    gp = gpar(cex = <span class="number">0.8</span>, col = <span class="string">"orange"</span>))</span><br><span class="line">grid.edit(gPath(<span class="string">"myLDgrob"</span>, <span class="string">"Key"</span>, <span class="string">"title"</span>), gp = gpar(cex = <span class="number">1.25</span>,</span><br><span class="line">    col = <span class="string">"red"</span>))</span><br></pre></td></tr></table></figure>
<p>or we can do so statically with</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LD.grob1 &lt;- editGrob(MyHeatmap$LDheatmapGrob,</span><br><span class="line">    gPath(<span class="string">"heatMap"</span>, <span class="string">"title"</span>), gp = gpar(cex = <span class="number">1.25</span>,</span><br><span class="line">    col = <span class="string">"blue"</span>))</span><br><span class="line">LD.grob2 &lt;- editGrob(LD.grob1, gPath(<span class="string">"geneMap"</span>,</span><br><span class="line">    <span class="string">"title"</span>), gp = gpar(cex = <span class="number">0.8</span>, col = <span class="string">"orange"</span>))</span><br><span class="line">LD.grob3 &lt;- editGrob(LD.grob2, gPath(<span class="string">"Key"</span>, <span class="string">"title"</span>),</span><br><span class="line">    gp = gpar(cex = <span class="number">1.25</span>, col = <span class="string">"red"</span>))</span><br></pre></td></tr></table></figure>
<p>The final grob, LD.grob3, can be drawn with</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grid.newpage()</span><br><span class="line">grid.draw(LD.grob3)</span><br></pre></td></tr></table></figure>
<p>For more information on the functions <code>grid.edit()</code>, <code>editGrob()</code>, <code>grid.newpage()</code> and <code>grid.draw()</code> from the grid package, see their respective help files or Murrell (2006a). Figure 3 shows the resulting modified heat map.</p>
<p><img src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure3.png" alt="Figure 3: Heat map with modified colors and font sizes for &quot;Pairwise LD in r^2&quot; (main title), &quot;Physical Length:8.9kb&quot; (genetic length text) and &quot;Color Key&quot; (color-scale title)."></p>
<h2 id="5-Multiple-heat-maps-on-a-single-device"><a href="#5-Multiple-heat-maps-on-a-single-device" class="headerlink" title="5. Multiple heat maps on a single device"></a>5. Multiple heat maps on a single device</h2><p>Displaying multiple heat maps on one graphical device may be useful for making comparisons. However, as mentioned earlier, changing <code>par()</code> settings does not affect grid graphics; hence modifying settings of <code>mfrow()</code> or <code>mfcol()</code> for arranging multiple plots in the traditional graphics system are not compatible with <code>LDheatmap()</code>. In the grid graphics system, multiple regions on a device can be defined and plotted by controlling grid viewports (Murrell 2006b). One possible way to display and arrange multiple heat maps produced by <code>LDheatmap()</code> is with a layout (Murrell 1999). Alternately, users may manually position heat maps. Either approach involves controlling grid viewports and navigating the viewport tree managed by grid (Murrell 2006b). In the following example two heat maps of different color scales (grey and white-to-red) are displayed side-by-side by manual positioning.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">VP1 &lt;- viewport(x = <span class="number">0</span>, y = <span class="number">0</span>, width = <span class="number">0.5</span>, height = <span class="number">1</span>,</span><br><span class="line">    just = c(<span class="string">"left"</span>, <span class="string">"bottom"</span>), name = <span class="string">"vp1"</span>)</span><br><span class="line">pushViewport(VP1)</span><br><span class="line">LD1 &lt;- LDheatmap(MyHeatmap, color = grey.colors(<span class="number">20</span>),</span><br><span class="line">    title = <span class="string">"Pairwise LD in grey.colors(20)"</span>,</span><br><span class="line">    SNP.name = <span class="string">"rs6979572"</span>, name = <span class="string">"ld1"</span>, newpage = <span class="literal">FALSE</span>)</span><br><span class="line">upViewport()</span><br><span class="line">VP2 &lt;- viewport(x = <span class="number">0.5</span>, y = <span class="number">0</span>, width = <span class="number">0.5</span>, height = <span class="number">1</span>,</span><br><span class="line">    just = c(<span class="string">"left"</span>, <span class="string">"bottom"</span>), name = <span class="string">"vp2"</span>)</span><br><span class="line">pushViewport(VP2)</span><br><span class="line">LD2 &lt;- LDheatmap(MyHeatmap, color = heat.colors(<span class="number">20</span>),</span><br><span class="line">    title = <span class="string">"Pairwise LD in heat.colors(20)"</span>,</span><br><span class="line">    SNP.name = <span class="string">"rs6979572"</span>, name = <span class="string">"ld2"</span>, newpage = <span class="literal">FALSE</span>)</span><br><span class="line">upViewport()</span><br></pre></td></tr></table></figure>
<p>The argument <code>newpage=FALSE</code> tells <code>LDheatmap()</code> not to erase previously defined viewports: in the first call to <code>LDheatmap()</code> do not erase viewport VP1, and in the second function call do not erase VP1 or VP2.<br>Our next example shows how to use the <code>grid.edit()</code> function to modify the LDheatmapGrobs “ld1” and “ld2”, created in the previous example, so that white lines separate each pixel in the heat map displayed on the left and so that the color of the “geneMap” title along the diagonal is changed from black (the default) to blue in the heat map displayed on the right.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grid.edit(gPath(<span class="string">"ld1"</span>, <span class="string">"heatMap"</span>, <span class="string">"heatmap"</span>),</span><br><span class="line">    gp = gpar(col = <span class="string">"white"</span>, lwd = <span class="number">2</span>))</span><br><span class="line">grid.edit(gPath(<span class="string">"ld2"</span>, <span class="string">"geneMap"</span>, <span class="string">"title"</span>), gp = gpar(col = <span class="string">"blue"</span>))</span><br></pre></td></tr></table></figure>
<p>Note that the gPaths in the two calls to <code>grid.edit()</code> name the top-level grobs “ld1” and “ld2”, respectively, to specify which heat map is going be modified. Figure 4 shows the two modified heat maps displayed together.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data(<span class="string">"CHBJPTData"</span>)</span><br><span class="line">pop &lt;- factor(c(rep(<span class="string">"chinese"</span>, <span class="number">45</span>), rep(<span class="string">"japanese"</span>,</span><br><span class="line">    <span class="number">45</span>)))</span><br></pre></td></tr></table></figure>
<p>Our final example shows how to produce a lattice-like plot with LDheatmaps in the panels, which is useful for viewing patterns of LD in different populations. The command</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data(<span class="string">"CHBJPTData"</span>)</span><br></pre></td></tr></table></figure>
<p>loads the genotypes <code>CHBJPTSNP</code> and associated distance vector <code>CHBJPTDist</code>. The data frame <code>CHBJPTSNP</code> contains genotypes for 13 SNPs on chromosome 7, from 45 Chinese and 45 Japanese individuals. The Chinese individuals were unrelated residents of the community at Beijing Normal University with at least 3 Han Chinese grandparents. The Japanese individuals were unrelated residents of the Tokyo metropolitan area with all grandparents from Japan. The data are from release 21 of the International HapMap project (The International HapMap Consortium 2005). We first create a factor variable describing the population:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pop &lt;- factor(c(rep(<span class="string">"chinese"</span>, <span class="number">45</span>), rep(<span class="string">"japanese"</span>,</span><br><span class="line">    <span class="number">45</span>)))</span><br></pre></td></tr></table></figure>
<p>The population variable may then be used to stratify the heat maps as follows.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(lattice)</span><br><span class="line">xyplot(<span class="number">1</span>:nrow(CHBJPTSNP) ~ <span class="number">1</span>:nrow(CHBJPTSNP) |</span><br><span class="line">    pop, type = <span class="string">"n"</span>, scales = list(draw = <span class="literal">FALSE</span>),</span><br><span class="line">    xlab = <span class="string">""</span>, ylab = <span class="string">""</span>, panel = <span class="keyword">function</span>(x,</span><br><span class="line">        y, subscripts, <span class="keyword">...</span>) &#123;</span><br><span class="line">        LDheatmap(CHBJPTSNP[subscripts, ], CHBJPTDist,</span><br><span class="line">            newpage = <span class="literal">FALSE</span>)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>
<p>The resulting heat maps are shown in Figure 5.</p>
<h2 id="6-Further-Notes"><a href="#6-Further-Notes" class="headerlink" title="6. Further Notes"></a>6. Further Notes</h2><p>The package <code>LDheatmap</code> contains two other functions written in the grid graphics system. <code>LDheatmap.highlight()</code> and <code>LDheatmap.marks()</code> can be used to highlight or mark with a symbol, respectively, pairwise LD measures on an LD heat map. For more details, see the documentation for the LDheatmap package.</p>
<h2 id="7-Acknowledgments"><a href="#7-Acknowledgments" class="headerlink" title="7. Acknowledgments"></a>7. Acknowledgments</h2><p>We would like to thank Nicholas Lewin-Koh for his suggestion to modify our original implementation of <code>LDheatmap()</code> to use the grid graphics system, and for his work to develop the <code>LDheatmap.highlight()</code> and <code>LDheatmap.marks()</code> functions in the LDheatmap package. We also would like to thank the anonymous reviewers for their helpful comments regarding the package and manuscript. This research was supported by Natural Sciences and Engineering Research Council of Canada grants 227972-00 and 213124-03, by Juvenile Diabetes Research Foundation International grant 1-2001-873, by Canadian Institutes of Health Research grants NPG-64869 and ATF-66667, and in part by the Mathematics of Information Technology and Complex Systems, Canadian National Centres of Excellence. JG is a Scholar of the BC Michael Smith Foundation for Health Research.</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li>Lewontin R (1964). “The Interaction of Selection and Linkage. I. General Considerations; Heterotic Models.” Genetics, 49, 49–67.</li>
<li>Murrell P (1999). “Layouts: A Mechanism for Arranging Plots on a Page.” Journal of Computational and Graphical Statistics, 8, 121–134.</li>
<li>Murrell P (2005). R Graphics. Chapman &amp; Hall/CRC, Boca Raton, Florida.</li>
<li>Murrell P (2006a). “Modifying grid grobs.” R grid package vignette.</li>
<li>Murrell P (2006b). “Working with grid Viewports.” R grid package vignette.</li>
<li>Pritchard J, Przeworski M (2001). “Linkage Disequilibrium in Humans: Models and Data.” The American Journal of Human Genetics, 69, 1–14.</li>
<li>R Development Core Team (2006). R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0, URL http: //www.R-project.org/.</li>
<li>The International HapMap Consortium (2005). “A Haplotype Map of the Human Genome.” Nature, 437, 1299–1320.</li>
<li>Warnes G, Leisch F (2005). genetics: Population Genetics. R package version 1.2.0.</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure4.png" alt="Figure 4: Modified heat maps displayed together."></p>
<blockquote>
<p>Figure 4: Modified heat maps displayed together. The heat map on the left uses a ‘grey’ (grey.colors(20)) color-scale. The heat map on the right uses a ‘white-to-red’ (heat.colors(20)) color-scale. White grid-lines were added to the heat map on the left and the color of the text “Physical Length:8.9kb” was changed from black to blue in the heat map on the right.</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/R/LDheatmap/Figure5.png" alt="Figure 5: Lattice-like plot with LD heat maps in the panels."></p>
<blockquote>
<p><img src="https://raw.githubusercontent.com/xieguigang/xieguigang.github.io-hexo/master/images/qrcode/LDheatmap.png" alt="LDheatmap: An R Function for Graphical Display of Pairwise Linkage Disequilibria between Single Nucleotide Polymorphisms"></p>
</blockquote>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

    <a data-url="http://blog.xieguigang.me/2016/08/21/LDheatmap/" data-id="cis4u5mhp0000ssv4pvbk7szc" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        // Prevent duplicate binding
        if (typeof(__SHARE_BUTTON_BINDED__) === 'undefined' || !__SHARE_BUTTON_BINDED__) {
            __SHARE_BUTTON_BINDED__ = true;
        } else {
            return;
        }
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="fa fa-twitter article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="fa fa-facebook article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="fa fa-pinterest article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="fa fa-google article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

            
    
        <a href="http://blog.xieguigang.me/2016/08/21/LDheatmap/#comments" class="article-comment-link disqus-comment-count" data-disqus-url="http://blog.xieguigang.me/2016/08/21/LDheatmap/">Comments</a>
    

        </footer>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2016/08/22/vb_CLI_pipeline/" id="article-nav-newer" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Newer</strong>
            <div class="article-nav-title">
                
                    VisualBasic CLI Pipeline
                
            </div>
        </a>
    
    
        <a href="/2016/08/20/OMIM/" id="article-nav-older" class="article-nav-link-wrap">
            <strong class="article-nav-caption">Older</strong>
            <div class="article-nav-title">OMIM API tools manual</div>
        </a>
    
</nav>


    
</article>


    
    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

</section>
            
                <aside id="sidebar">
   
        
    
        
    <div class="widget-wrap">
        <h3 class="widget-title">archives</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">23</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">22</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">tag cloud</h3>
        <div class="widget tagcloud">
            <a href="/tags/3D/" style="font-size: 10px;">3D</a> <a href="/tags/3d/" style="font-size: 10px;">3d</a> <a href="/tags/3d-graphics/" style="font-size: 10px;">3d graphics</a> <a href="/tags/Array/" style="font-size: 10px;">Array</a> <a href="/tags/BI/" style="font-size: 11.67px;">BI</a> <a href="/tags/CLI/" style="font-size: 10px;">CLI</a> <a href="/tags/Chinese/" style="font-size: 10px;">Chinese</a> <a href="/tags/Chinese-rural-dog/" style="font-size: 10px;">Chinese rural dog</a> <a href="/tags/CodeProject/" style="font-size: 15px;">CodeProject</a> <a href="/tags/Compiler/" style="font-size: 10px;">Compiler</a> <a href="/tags/Desktop/" style="font-size: 10px;">Desktop</a> <a href="/tags/Dictionary/" style="font-size: 10px;">Dictionary</a> <a href="/tags/Enigma/" style="font-size: 13.33px;">Enigma</a> <a href="/tags/GAM/" style="font-size: 10px;">GAM</a> <a href="/tags/GCModeller/" style="font-size: 11.67px;">GCModeller</a> <a href="/tags/HoloLens/" style="font-size: 10px;">HoloLens</a> <a href="/tags/IE/" style="font-size: 10px;">IE</a> <a href="/tags/Linq/" style="font-size: 10px;">Linq</a> <a href="/tags/Lumia/" style="font-size: 10px;">Lumia</a> <a href="/tags/MSDN/" style="font-size: 10px;">MSDN</a> <a href="/tags/Manhattan-Plot/" style="font-size: 10px;">Manhattan Plot</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Microsoft/" style="font-size: 10px;">Microsoft</a> <a href="/tags/OMIM/" style="font-size: 10px;">OMIM</a> <a href="/tags/PDB/" style="font-size: 10px;">PDB</a> <a href="/tags/Phylostratigraphic/" style="font-size: 10px;">Phylostratigraphic</a> <a href="/tags/PowerBI/" style="font-size: 10px;">PowerBI</a> <a href="/tags/R/" style="font-size: 15px;">R</a> <a href="/tags/R-squared/" style="font-size: 10px;">R-squared</a> <a href="/tags/SDK-document/" style="font-size: 10px;">SDK document</a> <a href="/tags/SNP/" style="font-size: 15px;">SNP</a> <a href="/tags/SVG/" style="font-size: 10px;">SVG</a> <a href="/tags/String/" style="font-size: 10px;">String</a> <a href="/tags/Surface-Book/" style="font-size: 10px;">Surface Book</a> <a href="/tags/Syntax/" style="font-size: 10px;">Syntax</a> <a href="/tags/UI/" style="font-size: 10px;">UI</a> <a href="/tags/VisualStudio/" style="font-size: 10px;">VisualStudio</a> <a href="/tags/WPF/" style="font-size: 10px;">WPF</a> <a href="/tags/XAML/" style="font-size: 10px;">XAML</a> <a href="/tags/YAML/" style="font-size: 10px;">YAML</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/architecture/" style="font-size: 11.67px;">architecture</a> <a href="/tags/art-work/" style="font-size: 10px;">art work</a> <a href="/tags/async/" style="font-size: 10px;">async</a> <a href="/tags/bash/" style="font-size: 10px;">bash</a> <a href="/tags/check-point/" style="font-size: 10px;">check-point</a> <a href="/tags/chrome/" style="font-size: 10px;">chrome</a> <a href="/tags/circos/" style="font-size: 11.67px;">circos</a> <a href="/tags/cytoscape-js/" style="font-size: 11.67px;">cytoscape.js</a> <a href="/tags/d3js/" style="font-size: 13.33px;">d3js</a> <a href="/tags/data-analysis/" style="font-size: 10px;">data analysis</a> <a href="/tags/data-visualization/" style="font-size: 10px;">data visualization</a> <a href="/tags/desktop/" style="font-size: 10px;">desktop</a> <a href="/tags/document/" style="font-size: 10px;">document</a> <a href="/tags/elementary-os/" style="font-size: 10px;">elementary os</a> <a href="/tags/firefox/" style="font-size: 10px;">firefox</a> <a href="/tags/force-directed/" style="font-size: 10px;">force directed</a> <a href="/tags/gdi/" style="font-size: 11.67px;">gdi+</a> <a href="/tags/genetics/" style="font-size: 13.33px;">genetics</a> <a href="/tags/github/" style="font-size: 16.67px;">github</a> <a href="/tags/heatmap/" style="font-size: 10px;">heatmap</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/interface/" style="font-size: 10px;">interface</a> <a href="/tags/javascript/" style="font-size: 18.33px;">javascript</a> <a href="/tags/jquery/" style="font-size: 10px;">jquery</a> <a href="/tags/language/" style="font-size: 10px;">language</a> <a href="/tags/languages/" style="font-size: 10px;">languages</a> <a href="/tags/libzplay/" style="font-size: 10px;">libzplay</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/math/" style="font-size: 10px;">math</a> <a href="/tags/mgcv/" style="font-size: 10px;">mgcv</a> <a href="/tags/music/" style="font-size: 16.67px;">music</a> <a href="/tags/my-works/" style="font-size: 10px;">my works</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/note/" style="font-size: 18.33px;">note</a> <a href="/tags/open-source/" style="font-size: 10px;">open-source</a> <a href="/tags/perl/" style="font-size: 10px;">perl</a> <a href="/tags/pipeline/" style="font-size: 10px;">pipeline</a> <a href="/tags/re0/" style="font-size: 10px;">re0</a> <a href="/tags/rem/" style="font-size: 10px;">rem</a> <a href="/tags/repost/" style="font-size: 16.67px;">repost</a> <a href="/tags/statics/" style="font-size: 10px;">statics</a> <a href="/tags/svg/" style="font-size: 10px;">svg</a> <a href="/tags/threading/" style="font-size: 10px;">threading</a> <a href="/tags/threadpool/" style="font-size: 10px;">threadpool</a> <a href="/tags/tricks/" style="font-size: 10px;">tricks</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/user-agent/" style="font-size: 10px;">user-agent</a> <a href="/tags/vb-net/" style="font-size: 20px;">vb.net</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web-api/" style="font-size: 10px;">web api</a> <a href="/tags/web-server/" style="font-size: 10px;">web server</a> <a href="/tags/win10/" style="font-size: 10px;">win10</a> <a href="/tags/works/" style="font-size: 10px;">works</a> <a href="/tags/中華田園犬/" style="font-size: 10px;">中華田園犬</a> <a href="/tags/前端/" style="font-size: 10px;">前端</a> <a href="/tags/前端设计/" style="font-size: 13.33px;">前端设计</a> <a href="/tags/数据分析/" style="font-size: 10px;">数据分析</a> <a href="/tags/数据可视化/" style="font-size: 11.67px;">数据可视化</a> <a href="/tags/数据视图/" style="font-size: 10px;">数据视图</a> <a href="/tags/架构/" style="font-size: 11.67px;">架构</a> <a href="/tags/架构设计/" style="font-size: 10px;">架构设计</a> <a href="/tags/线程池/" style="font-size: 10px;">线程池</a> <a href="/tags/转载/" style="font-size: 10px;">转载</a> <a href="/tags/转载搬运/" style="font-size: 16.67px;">转载搬运</a> <a href="/tags/连锁不平衡/" style="font-size: 11.67px;">连锁不平衡</a> <a href="/tags/遗传学/" style="font-size: 11.67px;">遗传学</a> <a href="/tags/非线性拟合/" style="font-size: 10px;">非线性拟合</a> <a href="/tags/鹿乃/" style="font-size: 10px;">鹿乃</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">links</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://framework-docs.xieguigang.me/">VisualBasic Framework</a>
                    </li>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
                    <li>
                        <a href="http://gcmodeller.org">http://gcmodeller.org</a>
                    </li>
                
                    <li>
                        <a href="https://github.com/genetics-potato">https://github.com/genetics-potato</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2016 しゃけい よしつな<br>
            Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="http://github.com/ppoffice">PPOffice</a>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_config = function () {
        
            this.page.url = 'http://blog.xieguigang.me/2016/08/21/LDheatmap/';
        
        this.page.identifier = 'LDheatmap';
    };
    (function() { 
        var d = document, s = d.createElement('script');  
        s.src = '//' + 'xieguigang' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>



    
        <script src="/vendor/fancybox/jquery.fancybox.pack.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>