<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>What does the Visual Studio “Any CPU” target mean? | 拾荒者</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="stackoverflow: http://stackoverflow.com/questions/516730/what-does-the-visual-studio-any-cpu-target-mean

An AnyCPU assembly will JIT to 64 bit code when loaded into 64 bit process and 32 bit when lo">
<meta property="og:type" content="article">
<meta property="og:title" content="What does the Visual Studio “Any CPU” target mean?">
<meta property="og:url" content="http://yoursite.com/2016/06/11/CLR_types/index.html">
<meta property="og:site_name" content="拾荒者">
<meta property="og:description" content="stackoverflow: http://stackoverflow.com/questions/516730/what-does-the-visual-studio-any-cpu-target-mean

An AnyCPU assembly will JIT to 64 bit code when loaded into 64 bit process and 32 bit when lo">
<meta property="og:updated_time" content="2016-06-26T03:43:47.105Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="What does the Visual Studio “Any CPU” target mean?">
<meta name="twitter:description" content="stackoverflow: http://stackoverflow.com/questions/516730/what-does-the-visual-studio-any-cpu-target-mean

An AnyCPU assembly will JIT to 64 bit code when loaded into 64 bit process and 32 bit when lo">
  
    <link rel="alternative" href="/atom.xml" title="拾荒者" type="application/atom+xml">
  
  
    <link rel="icon" href="http://xieguigang.me/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="https://avatars1.githubusercontent.com/u/9410171?v=3&amp;s=460" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">しゃけい よしつな</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="http://xieguigang.me/">HOME</a></li>
				        
							<li><a href="/archives">Archives</a></li>
				        
							<li><a href="/nuget">Works</a></li>
				        
							<li><a href="/about">About</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/xieguigang" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/ineat" title="weibo">weibo</a>
					        
								<a class="mail" target="_blank" href="mailto://I@xieguigang.me" title="mail">mail</a>
					        
								<a class="google" target="_blank" href="/xie.guigang@gmail.com" title="google">google</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/xieguigang" title="twitter">twitter</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/3d-graphics/" style="font-size: 10px;">3d graphics</a> <a href="/tags/CodeProject/" style="font-size: 16px;">CodeProject</a> <a href="/tags/Compiler/" style="font-size: 10px;">Compiler</a> <a href="/tags/Desktop/" style="font-size: 10px;">Desktop</a> <a href="/tags/GCModeller/" style="font-size: 10px;">GCModeller</a> <a href="/tags/Linq/" style="font-size: 10px;">Linq</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/R/" style="font-size: 10px;">R</a> <a href="/tags/SDK-document/" style="font-size: 10px;">SDK document</a> <a href="/tags/Syntax/" style="font-size: 10px;">Syntax</a> <a href="/tags/UI/" style="font-size: 10px;">UI</a> <a href="/tags/VisualStudio/" style="font-size: 10px;">VisualStudio</a> <a href="/tags/WPF/" style="font-size: 10px;">WPF</a> <a href="/tags/XAML/" style="font-size: 10px;">XAML</a> <a href="/tags/YAML/" style="font-size: 10px;">YAML</a> <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/architecture/" style="font-size: 12px;">architecture</a> <a href="/tags/bash/" style="font-size: 10px;">bash</a> <a href="/tags/check-point/" style="font-size: 10px;">check-point</a> <a href="/tags/circos/" style="font-size: 12px;">circos</a> <a href="/tags/d3js/" style="font-size: 12px;">d3js</a> <a href="/tags/data-visualization/" style="font-size: 10px;">data visualization</a> <a href="/tags/desktop/" style="font-size: 10px;">desktop</a> <a href="/tags/document/" style="font-size: 10px;">document</a> <a href="/tags/elementary-os/" style="font-size: 10px;">elementary os</a> <a href="/tags/genetics/" style="font-size: 10px;">genetics</a> <a href="/tags/github/" style="font-size: 12px;">github</a> <a href="/tags/language/" style="font-size: 10px;">language</a> <a href="/tags/libzplay/" style="font-size: 10px;">libzplay</a> <a href="/tags/music/" style="font-size: 14px;">music</a> <a href="/tags/my-works/" style="font-size: 10px;">my works</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/note/" style="font-size: 18px;">note</a> <a href="/tags/perl/" style="font-size: 10px;">perl</a> <a href="/tags/re0/" style="font-size: 10px;">re0</a> <a href="/tags/rem/" style="font-size: 10px;">rem</a> <a href="/tags/repost/" style="font-size: 12px;">repost</a> <a href="/tags/statics/" style="font-size: 10px;">statics</a> <a href="/tags/svg/" style="font-size: 10px;">svg</a> <a href="/tags/tricks/" style="font-size: 10px;">tricks</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/user-agent/" style="font-size: 10px;">user-agent</a> <a href="/tags/vb-net/" style="font-size: 20px;">vb.net</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/win10/" style="font-size: 10px;">win10</a> <a href="/tags/works/" style="font-size: 10px;">works</a> <a href="/tags/前端/" style="font-size: 10px;">前端</a> <a href="/tags/前端设计/" style="font-size: 14px;">前端设计</a> <a href="/tags/搬运转载/" style="font-size: 10px;">搬运转载</a> <a href="/tags/架构/" style="font-size: 10px;">架构</a> <a href="/tags/架构设计/" style="font-size: 10px;">架构设计</a> <a href="/tags/转载/" style="font-size: 10px;">转载</a> <a href="/tags/转载搬运/" style="font-size: 16px;">转载搬运</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://codeproject.com/">Code Project</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://gcmodeller.org/">GCModeller</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">大神在此！</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">しゃけい よしつな</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="https://avatars1.githubusercontent.com/u/9410171?v=3&amp;s=460" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">しゃけい よしつな</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="http://xieguigang.me/">HOME</a></li>
		        
					<li><a href="/archives">Archives</a></li>
		        
					<li><a href="/nuget">Works</a></li>
		        
					<li><a href="/about">About</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/xieguigang" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/ineat" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="mailto://I@xieguigang.me" title="mail">mail</a>
			        
						<a class="google" target="_blank" href="/xie.guigang@gmail.com" title="google">google</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/xieguigang" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-CLR_types" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/11/CLR_types/" class="article-date">
  	<time datetime="2016-06-10T16:00:00.000Z" itemprop="datePublished">2016-06-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      What does the Visual Studio “Any CPU” target mean?
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Compiler/">Compiler</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VisualStudio/">VisualStudio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/note/">note</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>stackoverflow: <a href="http://stackoverflow.com/questions/516730/what-does-the-visual-studio-any-cpu-target-mean" target="_blank" rel="external">http://stackoverflow.com/questions/516730/what-does-the-visual-studio-any-cpu-target-mean</a></p>
</blockquote>
<p>An <code>AnyCPU</code> assembly will <code>JIT</code> to <code>64 bit</code> code when loaded into <code>64 bit</code> process and <code>32 bit</code> when loaded into a <code>32 bit</code> process.<br>By limiting the CPU you would be saying there is something being used by the assembly (something likely unmanaged) that requires 32 bits or 64 bits.<br>I think most of the important stuff has been said, but I just thought I’d add one thing:</p>
<ul>
<li>If you compile as <code>Any CPU</code> and run on an <code>x64</code> platform, then you won’t be able to load 32-bit dlls, because your app wasn’t started in <code>WOW64</code>, but those dlls need to run there.</li>
<li>If you compile as <code>x86</code>, then the <code>x64</code> system will run you app in <code>WOW64</code>, and you’ll be able to load <code>32-bit</code> dlls.</li>
</ul>
<p>So I think you should choose <code>Any CPU</code> if your dependencies can run in either environment, but choose <code>x86</code> if you have <code>32-bit</code> dependencies. This article from Microsoft explains this a bit:</p>
<blockquote>
<p><a href="https://msdn.microsoft.com/en-us/library/31zwwc39.aspx" target="_blank" rel="external">/CLRIMAGETYPE (Specify Type of CLR Image)</a></p>
</blockquote>
<a id="more"></a>
<h2 id="CLRIMAGETYPE-Specify-Type-of-CLR-Image"><a href="#CLRIMAGETYPE-Specify-Type-of-CLR-Image" class="headerlink" title="/CLRIMAGETYPE (Specify Type of CLR Image)"></a>/CLRIMAGETYPE (Specify Type of CLR Image)</h2><p><code>Visual Studio 2015</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/CLRIMAGETYPE:&#123;IJW|PURE|SAFE|SAFE32BITPREFERRED&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Remarks"><a href="#Remarks" class="headerlink" title="Remarks"></a>Remarks</h4><p>The linker accepts native objects and also <code>MSIL</code> objects that are compiled by using <code>/clr</code>, <code>/clr:pure</code>, or <code>/clr:safe</code>. When mixed objects in the same build are passed, the verifiability of the resulting output file is, by default, equal to the lowest level of verifiability of the input modules. For example, if you pass both a safe and a pure module to the linker, the output file will be pure. If you pass a native image and a mixed mode image (compiled by using <code>/clr</code>), the resulting image will be a mixed mode image.<br>You can use <code>/CLRIMAGETYPE</code> to specify a lower level of verifiability, if that is what you need.<br>In .NET 4.5, <code>/CLRIMAGETYPE</code> supports a <code>SAFE32BITPREFERRED</code> option. This sets—in the <code>PE</code> header of the <code>image—flags</code> that indicate that the <code>MSIL</code> objects are safe and can be run on all platforms, but that <code>32-bit</code> execution environments are preferred. This option enables an app to run on ARM platforms and also specifies that it should run under <code>WOW64</code> on <code>64-bit</code> operating systems instead of using the <code>64-bit</code> execution environment.<br>When an <code>.exe</code> that was compiled by using <code>/clr</code> or <code>/clr:pure</code> is run on a <code>64-bit</code> operating system, the application is run under <code>WOW64</code>, which enables a <code>32-bit</code> application to run on a <code>64-bit</code> operating system. By default, an .exe that’s compiled by using <code>/clr:safe</code> is run under the operating system’s <code>64-bit</code> support. However, it is possible that your safe application loads a <code>32-bit</code> component. In that case, a safe image running under the operating system’s <code>64-bit</code> support will fail when it loads the <code>32-bit</code> application. To ensure that a safe image continues to run when it loads a <code>32-bit</code> component on a <code>64-bit</code> operating system, use the <code>/CLRIMAGETYPE:SAFE32BITPREFERRED</code> option. If your code does not have to run on <code>ARM</code> platforms, you can specify the <code>/CLRIMAGETYPE:PURE</code> option to change the metadata (<code>.corflags</code>), marking it to be run under <code>WOW64</code> (and substituting your own entry symbol):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cl /clr:safe t.cpp /link /clrimagetype:pure /entry:?main@@$$HYMHXZ /subsystem:console</span><br></pre></td></tr></table></figure>
<p>For information about how to determine the <code>CLR</code> image type of a file, see <a href="https://msdn.microsoft.com/en-us/library/ds03hhk8.aspx" target="_blank" rel="external"><code>/CLRHEADER</code></a>.</p>
<h5 id="To-set-this-linker-option-in-the-Visual-Studio-development-environment"><a href="#To-set-this-linker-option-in-the-Visual-Studio-development-environment" class="headerlink" title="To set this linker option in the Visual Studio development environment"></a>To set this linker option in the Visual Studio development environment</h5><p>Open the project’s <strong>Property Pages</strong> dialog box. For details, see <a href="https://msdn.microsoft.com/en-us/library/e79xc5h1.aspx" target="_blank" rel="external">How to: Open Project Property Pages</a>.<br>Expand the <strong>Configuration Properties</strong> node.<br>Expand the <strong>Linker</strong> node.<br>Select the <strong>Advanced</strong> property page.<br>Modify the <strong>CLR Image Type</strong> property.</p>
<h5 id="To-set-this-linker-option-programmatically"><a href="#To-set-this-linker-option-programmatically" class="headerlink" title="To set this linker option programmatically"></a>To set this linker option programmatically</h5><p>See <a href="https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.vcprojectengine.vclinkertool.clrimagetype.aspx" target="_blank" rel="external">CLRImageType</a>.</p>
<h5 id="See-Also"><a href="#See-Also" class="headerlink" title="See Also"></a>See Also</h5><p><a href="https://msdn.microsoft.com/en-us/library/wk97ab1b.aspx" target="_blank" rel="external">Setting Linker Options</a><br><a href="https://msdn.microsoft.com/en-us/library/y0zzbyt4.aspx" target="_blank" rel="external">Linker Options</a></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/06/14/my-win10/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          My Windows10 Desktop
        
      </div>
    </a>
  
  
    <a href="/2016/06/11/simple_svg/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Simple SVG</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>








<section id="comments">
  <div id="disqus_thread"></div>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'xieguigang'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>

</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 しゃけい よしつな
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>